!function(e){var t={};function a(r){if(t[r])return t[r].exports;var l=t[r]={i:r,l:!1,exports:{}};return e[r].call(l.exports,l,l.exports,a),l.l=!0,l.exports}a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)a.d(r,l,function(t){return e[t]}.bind(null,l));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=1)}([function(e,t,a){},function(e,t,a){"use strict";a.r(t);const{createElement:r,useState:l,useEffect:n,Fragment:s,render:i}=wp.element,{dispatch:m,select:c}=wp.data;var o=e=>{const[t,a]=l(!0),[r,s]=l(e.field),[i,m]=l(),[c,o]=l({height:"100%",width:"100%"}),[p,b]=l(!1),[d,v]=l(),[_,g]=l(),[u,y]=l(),[f,w]=l(""),[E,h]=l([]);n(()=>{if(e.center&&!t&&p&&d){let t=new google.maps.LatLng(e.center.lat,e.center.lng);console.log("setting center"),d.setCenter(t)}},[e.center,t,p,d]),n(()=>{if(e.members.length&&!t&&p&&d){var a=e.members.map(e=>new google.maps.Marker({position:new google.maps.LatLng(parseFloat(e.location.lat),parseFloat(e.location.lng)),map:d,label:e.display_name,title:e.display_name,animation:google.maps.Animation.DROP,visible:!0,icon:{url:window.vibebpmembers.api.map_marker,size:new google.maps.Size(51,32),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(21,30)}}));console.log(a),g(a)}},[e.members,p,d,t]),n(()=>{if(i)if(window.hasOwnProperty("google")&&window.google.hasOwnProperty("maps")){b(!0);var t={zoom:16,center:new google.maps.LatLng(e.center.lat,e.center.lng),mapTypeId:google.maps.MapTypeId.ROADMAP,imageDefaultUI:!0},r=new google.maps.Map(i,t);v(r),a(!1),e.loaded()}else{var l=window.document.createElement("script");l.src=`https://maps.googleapis.com/maps/api/js?v=3&sensor=true&key=${window.vibebpmembers.api.google_maps_api_key}&libraries=places`,l.async=!0,window.document.body.appendChild(l),l.addEventListener("load",()=>{b(!0),e.loaded();var t=new google.maps.LatLng(e.center.lat,e.center.lng),r=new google.maps.StyledMapType([{elementType:"geometry",stylers:[{color:"#212121"}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{elementType:"labels.text.stroke",stylers:[{color:"#212121"}]},{featureType:"administrative",elementType:"geometry",stylers:[{color:"#757575"}]},{featureType:"administrative.country",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#bdbdbd"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#181818"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"poi.park",elementType:"labels.text.stroke",stylers:[{color:"#1b1b1b"}]},{featureType:"road",elementType:"geometry.fill",stylers:[{color:"#2c2c2c"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#8a8a8a"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#373737"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#3c3c3c"}]},{featureType:"road.highway.controlled_access",elementType:"geometry",stylers:[{color:"#4e4e4e"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"transit",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#000000"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#3d3d3d"}]}],{name:"Styled Map"}),l={zoom:16,center:t,mapTypeId:"styled_map",imageDefaultUI:!0},n=new google.maps.Map(i,l);n.mapTypes.set("styled_map",r),n.setMapTypeId("styled_map"),v(n),a(!1),y(new google.maps.Geocoder)})}},[i]);return React.createElement("div",{className:"vibebp_members_directory_google_map"},React.createElement("div",{className:"vibebp_members_directory_google_map_wrapper"},t?React.createElement("div",{className:"loading-roller"},React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null)):"",React.createElement("div",{className:"vibebp_gmap",ref:e=>{e&&!i&&m(e)},style:c})))};const{createElement:p,useState:b,useEffect:d,Fragment:v,render:_}=wp.element,{dispatch:g,select:u}=wp.data;var y=e=>React.createElement("div",{class:"vibebp-directory-content-block"},React.createElement("div",{class:"loader-wrapper"},React.createElement("div",{class:"loader-animation"},React.createElement("svg",null,React.createElement("path",{d:"M442 79.1H0V65.5h412.4v-7.1H0V0h442v79.1zm0 7.1V107H181.2v-7.1H0V86.2h442zM50.1 24.6v7.2h53.3v-7.2H50.1zm0-16.8v7.1h89.3V7.8H50.1zM19.3 38.9c10.6 0 19.2-8.7 19.2-19.4C38.5 8.7 30 0 19.3 0A19.4 19.4 0 0 0 0 19.5c0 10.7 8.6 19.4 19.3 19.4z"})))));const{createElement:f,useState:w,useEffect:E,Fragment:h,render:R}=wp.element;var N=e=>{const[t,a]=w(!1),[r,l]=w(e.member),[n,s]=w("");E(()=>{s(""),e.member.hasOwnProperty("memberCard")?s(e.member.memberCard):(a(!0),fetch(`${window.vibebpmembers.api.url}/member_card/${e.member.id}?client_id=${window.vibebpmembers.api.client_id}&force`,{method:"get"}).then(e=>e.json()).then(e=>{a(!1),s(e)}))},[e.member]),E(()=>{n&&n.length&&e.update()},[n]);const i=a=>{if(!t){var l=new CustomEvent("member_card_clicked",{detail:{original_event:a,member:r,id:e.member.id}});document.dispatchEvent(l)}};return t?React.createElement("div",{className:"member_card"},React.createElement(y,null)):React.createElement("div",{className:"vibebp_member"},n.length?React.createElement("div",{className:"member_card",dangerouslySetInnerHTML:{__html:n},onClick:e=>{i(e)}}):React.createElement("a",{href:r.url,className:t?"opacity_10":""},React.createElement("img",{src:r.avatar,alt:r.display_name,onClick:e=>{i(e)}}),-1!==["names","pop_names"].indexOf(window.vibebpmembers.settings.card_style)?React.createElement("span",null,r.display_name):""))};const{createElement:T,useRef:k,useEffect:C,Fragment:O,render:x}=wp.element,P=(e,t,a=[])=>{const r=k(Date.now());C(()=>{const a=setTimeout((function(){Date.now()-r.current>=t&&(e(),r.current=Date.now())}),t-(Date.now()-r.current));return()=>{clearTimeout(a)}},[t,...a])};const{createElement:S,useState:M,useEffect:j,Fragment:L,render:I}=wp.element,{dispatch:z,select:D}=wp.data;var $=e=>{const[t,a]=M({member_type:"all"===window.vibebpmembers.settings.member_type?"":window.vibebpmembers.settings.member_type,full_avatar:window.vibebpmembers.settings.full_avatar,per_page:window.vibebpmembers.settings.members_per_page.size,page:1,search_terms:"",show_map:window.vibebpmembers.settings.show_map,filters:[],orderby:window.vibebpmembers.settings.order}),r=void 0!==window.vibebpmembers.settings.member_type_filter?window.vibebpmembers.settings.member_type_filter:[],[l,n]=M(1),[s,i]=M(0),[m,c]=M(""),[p,b]=M([]),[d,v]=M({}),[_,g]=M(!0),[u,y]=M([]),[f,w]=M(""),[E,h]=M(!1),[R,T]=M({lat:"-34.397",lng:"150.644"}),[k,C]=M([]),[O,x]=M([]),[S,I]=M(!1),[D,$]=M(!1),[A,F]=M(null),[H,V]=M(0);j(()=>{window.vibebpmembers.settings.show_map&&"geolocation"in navigator&&navigator.geolocation.getCurrentPosition((function(e){T({lat:e.coords.latitude,lng:e.coords.longitude})}))},[]),P(()=>{A&&A.abort();let a={},r=new AbortController;A&&(a={signal:r.signal}),F(r),I(!0),V(0),b([]),fetch(`${window.vibebpmembers.api.url}/members?client_id=${window.vibebpmembers.api.client_id}&force`,{method:"post",...a,body:JSON.stringify({...t,firstLoad:D})}).then(e=>e.json()).then(t=>{g(!1),I(!1),t.status&&D&&($(!1),Array.isArray(t.data.users)&&t.data.users.length&&t.data.users.map(t=>{z("vibebp").setData("member_"+e.member.id,JSON.stringify(t.memberCard))})),t.hasOwnProperty("status")&&(b(t.data.users),i(parseInt(t.data.total)))})},500,[t]),P(()=>{if(!_&&m.length){let e=new google.maps.places.AutocompleteService;m.length&&e.getQueryPredictions({input:m},(e,t)=>{if(t!=google.maps.places.PlacesServiceStatus.OK)return;let a=[...O];e.forEach((function(e){a.unshift(e.description)})),x(a)})}},500,[m]),j(()=>{window.vibebpmembers.settings.hasOwnProperty("member_directory_filters")&&window.vibebpmembers.settings.member_directory_filters&&window.vibebpmembers.settings.member_directory_filters.length&&fetch(`${window.vibebpmembers.api.url}/${window.vibebpmembers.api.xprofile}/field/options?client_id=${window.vibebpmembers.api.client_id}&force`,{method:"POST",body:JSON.stringify({fields:window.vibebpmembers.settings.member_directory_filters})}).then(e=>e.json()).then(e=>{e.status&&y(e.values)})},[]);const J=()=>{E&&(new google.maps.Geocoder).geocode({address:m},(e,t)=>{"OK"==t&&(console.log(e[0].geometry.location),T({lat:e[0].geometry.location.lat(),lng:e[0].geometry.location.lng()})),x([])})};return j(()=>{H==p.length&&p.length&&document.dispatchEvent(new Event("vibebp_all_members_loaded"))},[H,p]),React.createElement(L,null,window.vibebpmembers.settings.hasOwnProperty("show_map")&&window.vibebpmembers.settings.show_map?React.createElement(o,{loaded:()=>{h(!0)},center:R,members:p}):"",React.createElement("div",{className:window.vibebpmembers.settings.hasOwnProperty("show_map")&&window.vibebpmembers.settings.show_map?"horizontal_filters vibebp_members_directory_wrapper":"vibebp_members_directory_wrapper"},l?React.createElement("div",{className:"vibebp_members_directory_filters"},r.length&&Object.keys(window.vibebpmembers.member_types).length?React.createElement("div",{className:"member_types"===f?"vibebp_members_directory_filter active":"vibebp_members_directory_filter"},React.createElement("span",{onClick:()=>{w("member_types"!==f?"member_types":"")}},window.vibebpmembers.translations.member_types),React.createElement("div",{className:"member_types"},React.createElement("ul",null,-1===r.indexOf("all")?r.map(e=>React.createElement("li",null,React.createElement("a",{className:"member_type "+e+(t.member_type===e?"active":""),onClick:()=>{a({...t,member_type:e,page:1})}},window.vibebpmembers.member_types[e]))):React.createElement(L,null,React.createElement("li",null,React.createElement("a",{className:""===t.member_type?"member_type all active":"member_type all",onClick:()=>{a({...t,member_type:"",page:1})}},window.vibebpmembers.translations.all)),Object.keys(window.vibebpmembers.member_types).map(e=>React.createElement("li",null,React.createElement("a",{className:"member_type "+e+" "+(t.member_type===e?"active":""),onClick:()=>{a({...t,member_type:e,page:1})}},window.vibebpmembers.member_types[e]))))))):"",window.vibebpmembers.settings.show_map?React.createElement("div",{className:"map_search"===f?"vibebp_members_directory_filter active":"vibebp_members_directory_filter"},React.createElement("span",{onClick:()=>{w("map_search"!==f?"map_search":"")}},window.vibebpmembers.translations.map_search),React.createElement("div",{className:"vibebp_search_location_wrapper"},React.createElement("div",{className:"vibebp_radius_search"},React.createElement("span",{className:"vicon vicon-target",onClick:async()=>{E&&"geolocation"in navigator&&navigator.geolocation.getCurrentPosition((function(e){T({lat:e.coords.latitude,lng:e.coords.longitude})}))}}),React.createElement("div",{className:"search_radius_wrapper"},React.createElement("div",{className:"search_radius_bar"},React.createElement("span",{className:"radius_button",draggable:!0})))),React.createElement("div",{className:"vibebp_map_search_location"},React.createElement("div",{className:"vibebp_search_location"},React.createElement("input",{type:"text",value:m,onChange:e=>{c(e.target.value)}}),m.length?React.createElement("span",{className:"vicon vicon-close",onClick:()=>{c(""),x([])}}):"",React.createElement("span",{className:m.length?"vicon vicon-search is_active":"vicon vicon-search",onClick:J})),O.length?React.createElement("div",{className:"vibebp_autocomplete_results"},O.map(e=>React.createElement("div",{className:"vibebp_autocomplete_result",onClick:()=>{c(e),x([]),J()}},e))):""))):"",window.vibebpmembers.settings.member_directory_filters&&window.vibebpmembers.settings.hasOwnProperty("member_directory_filters")?React.createElement(L,null,window.vibebpmembers.settings.member_directory_filters?window.vibebpmembers.settings.member_directory_filters.map(e=>{let r=u.filter(t=>t.id===e.field_id);if(r.length)return React.createElement("div",{className:f===e.field_id?"vibebp_members_directory_filter active":"vibebp_members_directory_filter"},React.createElement("span",{onClick:()=>{f!==e.field_id?w(e.field_id):w("")}},e.name),r[0].values.length?React.createElement("div",{className:"vibebp_members_directory_filter_values"},r[0].values.map(r=>React.createElement("div",{className:"vibebp_members_directory_filter_values"},React.createElement("div",{className:"checkbox"},React.createElement("input",{type:"checkbox",id:"field_"+r.id,value:r.id,onChange:l=>{let n={...t},s=n.filters.findIndex(t=>t.field_id==e.field_id);s>-1?(n.filters[s].values.indexOf(r.name)>-1?(n.filters[s].values.splice(n.filters[s].values.indexOf(r.name),1),n.filters[s].values.length||n.filters.splice(s,1)):n.filters[s].values.push(r.name),n.page=1):(n.page=1,n.filters.push({field_id:e.field_id,type:e.type,values:[r.name]})),a(n)},checked:t.filters.findIndex(t=>t.field_id==e.field_id)>-1&&t.filters[t.filters.findIndex(t=>t.field_id==e.field_id)].values.indexOf(r.name)>-1}),React.createElement("label",{for:"field_"+r.id},r.name))))):"")}):""):""):"",React.createElement("div",{className:"vibebp_members_directory_main"},React.createElement("div",{className:"vibebp_members_directory_header"},React.createElement("span",null,React.createElement("span",{className:"close_filters",onClick:()=>n(!l)},React.createElement("span",null,l?window.vibebpmembers.translations.close_filters:window.vibebpmembers.translations.show_filters),React.createElement("span",{className:l?"vicon vicon-close":"vicon vicon-plus"})),window.vibebpmembers.settings.search_members?React.createElement("div",{className:"vibebp_members_search"},React.createElement("input",{type:"text",placeholder:window.vibebpmembers.translations.search_text,value:t.search_terms,onChange:e=>{a({...t,search_terms:e.target.value,page:1})}}),React.createElement("span",{className:"vicon vicon-search"})):""),window.vibebpmembers.settings.sort_members?React.createElement("div",{className:"vibebp_members_sort"},React.createElement("select",{value:t.orderby,onChange:e=>{a({...t,orderby:e.target.value,page:1})}},Object.keys(window.vibebpmembers.member_sorters).map(e=>React.createElement("option",{value:e},window.vibebpmembers.member_sorters[e])))):""),React.createElement("div",{className:"applied_filters"},React.createElement("span",null,t.filters.length?t.filters.map((e,a)=>e.values.map((e,r)=>React.createElement("span",{onClick:()=>{let e={...t};e.filters[a].values.splice(r,1),e.page=1}},e))):"",t.search_terms.length?React.createElement("span",null,t.search_terms):""),t.filters.length||t.search_terms.length?React.createElement("span",{onClick:()=>{a({...t,filters:[],search_terms:"",page:1})}},window.vibebpmembers.translations.clear_all):""),React.createElement("div",{className:"vibebp_members_directory "+window.vibebpmembers.settings.card_style},S?React.createElement("div",{class:"lds-ellipsis"},React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null)):p.length?p.map(e=>"card"===window.vibebpmembers.settings.card_style?React.createElement(N,{member:e,update:()=>{V(H+1)}}):React.createElement("div",{className:"vibebp_member"},React.createElement("a",{href:e.url},React.createElement("img",{src:e.avatar,alt:e.display_name}),-1!==["names","pop_names"].indexOf(window.vibebpmembers.settings.card_style)?React.createElement("span",null,e.display_name):""))):React.createElement("div",{className:"vibebp_message"},React.createElement("p",null,window.vibebpmembers.translations.no_members_found))),s>t.per_page?React.createElement("div",{class:"vibebp_members_directory_pagination"},(()=>{let e=[],r=0,l=Math.ceil(s/t.per_page);s>2&&1!==t.page&&(e.push(React.createElement("a",{className:"page",onClick:()=>{a({...t,page:1})}},React.createElement("span",{className:"vicon vicon-angle-double-left"}))),e.push(React.createElement("a",{className:"page",onClick:()=>{t.page>1&&a({...t,page:t.page-1})}},React.createElement("span",{className:"vicon vicon-angle-left"}))));for(let n=1;n<=l;n++)n===t.page?e.push(React.createElement("span",null,n)):n<t.page+3&&n<4||n<l&&n>l-3||n===t.page-1||n===t.page+1?e.push(React.createElement("a",{className:"page",onClick:()=>{a({...t,page:n})}},n)):r||(e.push(React.createElement("a",null,"...")),r++);return s>2&&t.page!==l&&(e.push(React.createElement("a",{className:"page",onClick:()=>{t.page<l&&a({...t,page:t.page+1})}},React.createElement("span",{className:"vicon vicon-angle-right"}))),e.push(React.createElement("a",{className:"page",onClick:()=>{a({...t,page:l})}},React.createElement("span",{className:"vicon vicon-angle-double-right"})))),e})()):"")))};a(0);const{createElement:A,useState:F,useEffect:H,Fragment:V,render:J}=wp.element,{dispatch:B,select:G}=wp.data,K=e=>React.createElement($,null);document.addEventListener("DOMContentLoaded",()=>{J(React.createElement(K,null),document.getElementById("vibebp_members_directory"))}),document.addEventListener("vibebpmembers_loaded",()=>{J(React.createElement(K,null),document.getElementById("vibebp_members_directory"))})}]);